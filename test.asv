function test

matrix_settings;
global_settings;
red = [255,0,0];
color = [20,200,2];
win0 = Screen(0,'OpenWindow',settings.BACKGROUND_COLOR,settings.screenRect,settings.COLOR_DEPTH);
win1 = Screen(win0,'OpenOffscreenWindow',red,settings.screenRect,settings.COLOR_DEPTH);
win2 = Screen(win0,'OpenOffscreenWindow',color,settings.screenRect,settings.COLOR_DEPTH);
winblank = Screen(win0,'OpenOffscreenWindow',settings.BLANK_SCREEN_COLOR,settings.screenRect,settings.COLOR_DEPTH);
winclear = Screen(win0,'OpenOffscreenWindow',settings.BACKGROUND_COLOR,settings.screenRect,settings.COLOR_DEPTH);

FlushEvents('keyDown'); % or drawnow
%___
while 1
    
    Screen('CopyWindow',win1,win0);
    display_start_time = tic;
    while (toc(display_start_time) <= 2) && (KbCheck == 0)
    end
    if KbCheck == 1
        %response_time = toc*1000;
        key = GetChar;
        if (key == 'q')||(key == 'Q')||(key == 'm')||(key == 'M')
            break
        end
    end
    
    Screen('CopyWindow',win2,win0);
    display_start_time = tic;
    while (toc(display_start_time) <= 2)&&(KbCheck == 0)
    end
    if KbCheck == 1
        %response_time = toc*1000;
        key = GetChar;
        if (key == 'q')||(key == 'Q')||(key == 'm')||(key == 'M')
            break
        end
    end
    
end

%___

%
% while 1
%     Screen('CopyWindow',win1,win0);
%     display_start_time = tic;
%     while (toc(display_start_time) > 2) || (KbCheck == 1)
%     end
%     Screen('CopyWindow',win1,win0);
%     display_start_time = tic;
%     while (toc(display_start_time) > 2)
%     end
%
%
%     Screen('CopyWindow',win2,win0);
%     WaitSecs(2)
%     [keyIsDown,secs,keyCode] = KbCheck;
%     if keyIsDown == 1
%         break
%     end
% end
% clear mex;
% Screen('CloseAll');
%


% while 1
%
%         while (KbCheck == 0) %&& (toc(display_start_time) > 1)
%             Screen('CopyWindow',win1,win0);
%         display_start_time = tic;
%             if KbCheck == 1
%                 response_time = (toc(trial_start_time))*1000;
%                 key = GetChar;
%               %  trial_end = 1;
%                 if (key == 'q')||(key == 'Q')||(key == 'm')||(key == 'M')
%                     break
%                 end
%             end
%         end
%     end
%     for screen_number = 1:2
% %        window_list = {win1, win2};
% %         win = window_list(screen_number);
%         if screen_number == 1
%             win = win1;
%         else
%             win = win2;
%         end

%             if toc(display_start_time) > SCREEN_DURATION
%                 break
%             end
%         end
%         if trial_end == 1
%             break
%         end
%     end
%     if trial_end == 1
%         break
%     end

clear mex;
Screen('CloseAll');